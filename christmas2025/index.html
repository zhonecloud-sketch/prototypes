<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Designed by Chong 2025 Dec</title>
    <style>
        :root {
            --card-red: #a51d1d;
            --card-white: #fdfdfd;
            --gold: #d4af37;
            --mitten-red: #c62828;
            --grey-text: #888888;
        }

        body {
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: radial-gradient(circle, #1a2a6c, #b21f1f, #fdbb2d);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            font-family: 'Palatino', 'Georgia', serif;
            perspective: 2000px;
            overflow: hidden;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .card-scene {
            width: 320px;
            height: 440px;
            position: relative;
            transform-style: preserve-3d;
            cursor: pointer;
            transition: transform 1s ease;
            margin-bottom: 40px;
        }

        .card {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
        }

        .flap {
            position: absolute;
            width: 100%;
            height: 50%;
            left: 0;
            transform-style: preserve-3d;
            transition: transform 1.4s cubic-bezier(0.4, 0, 0.2, 1);
            backface-visibility: hidden;
            box-sizing: border-box; /* ADD THIS: ensures borders stay inside the 50% height */
        }

        .top-flap {
            top: 0;
            transform-origin: bottom;
            z-index: 5;
            transform: rotateX(-179.5deg);
            /* Ensure the transition is smooth in both directions */
            transition: transform 1.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .cover-front {
            position: absolute;
            width: 100%;
            height: 100%;
            background: var(--card-red);
            border: 6px double var(--gold);
            border-radius: 15px 15px 0 0;
            box-sizing: border-box;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            transform: rotateX(180deg);
            backface-visibility: hidden;
        }

        .to-text {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 20px;
            font-weight: bold;
            font-style: italic;
        }

        .tap-to-unfold {
            position: absolute;
            bottom: 20px;
            width: 100%;
            text-align: center;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 2px;
            opacity: 0.8;
        }

        .cover-front h2 { margin: 0; font-size: 22px; text-align: center; line-height: 1.3; }

        .inside-top {
            position: absolute;
            width: 100%;
            height: 100%;
            background: var(--card-white);
            border-radius: 15px 15px 0 0;
            backface-visibility: hidden;
            border: 1px solid #eee;
        }

        .bottom-half {
            bottom: 0;
            background: var(--card-white);
            border-radius: 0 0 15px 15px;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            align-items: center;
            padding-bottom: 35px;
            z-index: 1;
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
        }

        .greetings-text { text-align: center; width: 85%; }

        .warm-wishes {
            font-size: 16px;
            line-height: 1.6;
            margin-bottom: 12px;
            color: var(--card-red);
            font-weight: bold;
        }

        .signature {
            color: var(--grey-text);
            font-style: italic;
            font-size: 14px;
        }

        /* SANTA ASSEMBLY */
        .santa-popup {
            position: absolute;
            width: 240px;
            height: 320px;
            bottom: 50%; 
            left: 50%;
            margin-left: -120px;
            transform-origin: bottom;

            /* Start rotated -90 degrees (lying flat on the bottom half) */
            transform: rotateX(-90deg); 
            opacity: 0;
            
            /* Synchronize both to 1.0s and use a "back" cubic-bezier */
            /* This bezier adds a slight "bounce" or "spring" at the start/end */
            transition: transform 1.0s cubic-bezier(0.34, 0.99, 0.64, 0.99), 
                opacity 1.0s ease;
                        
            z-index: 1000;
            display: flex;
            flex-direction: column;
            align-items: center;
            pointer-events: none;
            transform-style: preserve-3d;
        }

        .santa-face-svg {
            width: 160px; 
            height: 160px;
            position: relative;
            z-index: 1100;          /* 1. INCREASE this to be higher than .greeting-sign (1300) */
            margin-bottom: 20px;    /* 2. CHANGE to a negative value to pull the sign UP */
            /* 3. INCREASE translateY to push the face DOWN */
            transform: translateZ(5px) translateY(45px); 
        }

        .sign-holder {
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 1200; /* Group z-index high */
            width: 100%;
            transform-style: preserve-3d;
        }

        /* HANDS COVERING THE SIGN */
        .mitten { 
            width: 55px; 
            height: 55px; 
            position: absolute; 
            top: 185px; /* Add this line to move them down */
            z-index: 1500; /* Higher than greeting-sign */
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.3));
            /* Ensure hands are physically in front of the sign in 3D */
            transform-style: preserve-3d;
            backface-visibility: hidden;
        }
        
        .mitten-left { 
            left: -1px; /* Moved inward to cover part of the sign */
            transform: translateZ(12px) scaleX(-1) rotate(-10deg); 
        }
        
        .mitten-right { 
            right: -1px; /* Moved inward to cover part of the sign */
            transform: translateZ(12px) rotate(-10deg); 
        }

        .greeting-sign {
            background: white;
            border: 3px solid var(--card-red);
            padding: 8px 30px;
            border-radius: 8px;
            color: var(--card-red);
            font-weight: 900;
            font-size: 15px;
            white-space: nowrap;
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
            z-index: 1300; /* Lower than mittens */
            transform: translateZ(10px);
        }

        .card-scene.open .top-flap { transform: rotateX(0deg); }
        .card-scene.santa-reveal .santa-popup { 
            transform: rotateX(0deg); 
            opacity: 1; 
        }

        .instruction-pill {
            color: white;
            font-size: 14px;
            text-align: center;
            background: rgba(255,255,255,0.15);
            padding: 10px 25px;
            border-radius: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }
    </style>
</head>
<body>

    <div class="card-scene" id="cardContainer" onclick="handleCardClick()">
        <div class="card">
            
            <div class="santa-popup" id="santaPopup">
                <!-- 1. SANTA FACE -->
                <div class="santa-face-svg">
                    <svg width="100%" height="100%" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                        <path d="M30,45 C22,45 22,55 25,60 C20,65 20,75 26,80 C22,88 35,99 50,99 C65,99 78,88 74,80 C80,75 80,65 75,60 C78,55 78,45 70,45 Z" fill="white" stroke="black" stroke-width="0.8" />
                        <path d="M33,45 L67,45 L67,55 C67,65 33,65 33,55 Z" fill="#f7c8b0" />
                        <circle cx="38" cy="56" r="4" fill="#e59385" opacity="0.6" />
                        <circle cx="62" cy="56" r="4" fill="#e59385" opacity="0.6" />
                        <path d="M35,49 Q40,43 46,49 Q40,47 35,49 Z" fill="white" stroke="black" stroke-width="0.5" /> 
                        <path d="M54,49 Q60,43 65,49 Q60,47 54,49 Z" fill="white" stroke="black" stroke-width="0.5" />
                        <circle cx="42" cy="52" r="2.2" fill="#1a1a1a" /> 
                        <path d="M56,52 Q59,49 62,52" fill="none" stroke="black" stroke-width="1.2" stroke-linecap="round" />
                        <path d="M50,58 C42,56 32,63 30,50 C26,68 38,75 50,64 C62,75 74,68 70,50 C68,63 58,56 50,58 Z" fill="white" stroke="black" stroke-width="0.8" />
                        <path d="M44,71 Q50,76 56,71" fill="none" stroke="black" stroke-width="0.8" />
                        <circle cx="50" cy="59" r="4.5" fill="#d32f2f" stroke="black" stroke-width="0.5" />
                        <path d="M35,37 L50,18 L65,37 Z" fill="#d32f2f" stroke="black" stroke-width="0.8" /> 
                        <rect x="30" y="37" width="40" height="9" rx="4.5" fill="white" stroke="black" stroke-width="0.8" /> 
                        <circle cx="50" cy="18" r="4.5" fill="white" stroke="black" stroke-width="0.8" /> 
                    </svg>
                </div>

                <!-- 2. GREETING SIGN & HANDS (Mittens holding the sign) -->
                <div class="sign-holder">
                    <div class="greeting-sign">MERRY CHRISTMAS</div>
                </div>
                <div class="mitten mitten-left">
                    <svg viewBox="0 0 100 100">
                        <path d="M30,80 L30,40 C30,20 70,20 70,40 L70,80 Z" fill="var(--mitten-red)" stroke="black" stroke-width="3"/>
                        <path d="M70,50 C85,50 90,70 75,75" fill="var(--mitten-red)" stroke="black" stroke-width="3"/>
                        <rect x="25" y="75" width="50" height="15" rx="5" fill="white" stroke="#ccc" stroke-width="1"/>
                    </svg>
                </div>
                <div class="mitten mitten-right">
                    <svg viewBox="0 0 100 100">
                        <path d="M30,80 L30,40 C30,20 70,20 70,40 L70,80 Z" fill="var(--mitten-red)" stroke="black" stroke-width="3"/>
                        <path d="M70,50 C85,50 90,70 75,75" fill="var(--mitten-red)" stroke="black" stroke-width="3"/>
                        <rect x="25" y="75" width="50" height="15" rx="5" fill="white" stroke="#ccc" stroke-width="1"/>
                    </svg>
                </div>
            </div>

            <!-- Top Flap -->
            <div class="flap top-flap">
                <div class="cover-front">
                    <div class="to-text">To,</div>
                    <h2 id="recipientName">Friend<br>and Family</h2>
                    <div class="tap-to-unfold">Tap to Unfold</div>
                </div>
                <div class="inside-top"></div>
            </div>

            <!-- Bottom Base -->
            <div class="flap bottom-half">
                <div class="greetings-text">
                    <p class="warm-wishes">
                        Wishing you a season filled with warm hugs, happy hearts, and the magic of Christmas.
                    </p>
                    <p class="signature">
                        With all our love, Chong & Family
                    </p>
                </div>
            </div>

        </div>
    </div>

    <div class="instruction-pill" id="hint">Tap the card to unwrap a surprise!</div>

    <script>
        // 1. Personalize the name from the URL
        window.onload = function() {
            const urlParams = new URLSearchParams(window.location.search);
            const name = urlParams.get('to');
            if (name) {
                // Replaces "Friend and Family" with the name from the link
                document.getElementById('recipientName').innerHTML = name.replace(' ', '<br>');
            }
        }
    
        let isOpened = false;

        function handleCardClick() {
            const card = document.getElementById('cardContainer');
            const hint = document.getElementById('hint');

            if (!isOpened) {
                // OPENING SEQUENCE
                isOpened = true;
                card.classList.add('open');
                card.style.transform = "rotateX(22deg) translateY(-25px)";
                hint.style.opacity = "0";
                
                // Santa pops up shortly after the card starts opening
                setTimeout(() => { 
                    card.classList.add('santa-reveal'); 
                }, 500); 
            } else {
                // CLOSING SEQUENCE
                isOpened = false;
                
                // 1. Santa starts folding down immediately
                card.classList.remove('santa-reveal');
                
                // 2. WAIT for Santa to be almost flat before folding the main flap
                // We set this to 500ms so the flap starts closing while Santa is still moving
                setTimeout(() => {
                    card.classList.remove('open');
                    card.style.transform = "rotateX(0deg) translateY(0px)";
                    hint.style.opacity = "1";
                }, 500); 
            }
        }
    </script>
</body>
</html>